!define(["api","fun"],function(t,e){return document.title="我的会员",function(a){"use strict";$(function(){function n(){this.getUserInfo=function(){t({},{type:"GET",url:"api/user_info"}).then(function(t){if(t&&0==t.status){var e=t.data;$('[data-name="headimg_url"]',a).css("background-image",'url("'+e.headimg_url+'")'),$('[data-name="nick_name"]',a).html(e.nick_name),$('[data-name="credit"]',a).html(e.credit);var n=$('[data-btn="signIn"]',a);n.data("disabled",!1),1==e.sign_in&&(n.html("已签到"),n.data("signIn",!0))}})},this.getCreditRule=function(){t({},{type:"GET",url:"api/text?text_name=credit_rule"}).then(function(t){if(t&&0==t.status){var n=e.formTips(t.data);$('[data-name="creditRule"]',a).html(n)}}),t({},{type:"GET",url:"api/text?text_name=comsume_credit_rule"}).then(function(t){if(t&&0==t.status){var n=e.formTips(t.data);$('[data-name="comsumeCreditRule"]',a).html(n)}})}}$(".r-mainContainer").css("padding-bottom","14%"),a.on("click",".memberLi",function(t){var e=$(t.target);if(e.is("p"))return!1;if(e.is("span")&&(e=e.parent("li")),"link"===e.data("type"))return!1;var a=$(".memberLi-icon-slid",e);e.hasClass("opened")?(e.find(".memberLi-descWrap").hide(),e.removeClass("opened"),a.removeClass("opened").addClass("closed")):(e.find(".memberLi-descWrap").show(),e.addClass("opened"),a.removeClass("closed").addClass("opened")),e=null,a=null}).on("click",'[data-btn="signIn"]',function(e){var n=$(e.target);return 1!=n.data("disabled")&&("已签到"!==n.text()&&1!=n.data("signIn")&&void t({},{type:"GET",url:"api/sign_in"}).then(function(t){t&&0==t.status&&(n.html("已签到"),n.data("signIn",!0),$('[data-name="credit"]',a).html(t.data.credit))}))});var i=new n;i.getUserInfo(),i.getCreditRule()})}});