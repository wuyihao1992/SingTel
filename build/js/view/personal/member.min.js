!define(["api","fun"],function(e,t){return document.title="我的会员",function(a){"use strict";$(function(){function n(){this.getUserInfo=function(){e({},{type:"GET",url:"api/user_info"}).then(function(e){if(e&&0==e.status){var t=e.data;$('[data-name="headimg_url"]',a).css("background-image",'url("'+t.headimg_url+'")'),$('[data-name="nick_name"]',a).html(t.nick_name),$('[data-name="credit"]',a).html(t.credit);var n=$('[data-btn="signIn"]',a);n.data("disabled",!1),1==t.sign_in&&(n.html("已签到"),n.data("signIn",!0))}})},this.getCreditRule=function(){e({},{type:"GET",url:"api/text?text_name=credit_rule"}).then(function(e){if(e&&0==e.status){var n=t.formTips(e.data);$('[data-name="creditRule"]',a).html(n)}}),e({},{type:"GET",url:"api/text?text_name=comsume_credit_rule"}).then(function(e){if(e&&0==e.status){var n=t.formTips(e.data);$('[data-name="comsumeCreditRule"]',a).html(n)}})}}a.on("click",".memberLi",function(e){var t=$(e.target);if(t.is("p"))return!1;if(t.is("span")&&(t=t.parent("li")),"link"===t.data("type"))return!1;var a=$(".memberLi-icon-slid",t);t.hasClass("opened")?(t.find(".memberLi-descWrap").hide(),t.removeClass("opened"),a.removeClass("opened").addClass("closed")):(t.find(".memberLi-descWrap").show(),t.addClass("opened"),a.removeClass("closed").addClass("opened")),t=null,a=null}).on("click",'[data-btn="signIn"]',function(t){var n=$(t.target);return 1!=n.data("disabled")&&("已签到"!==n.text()&&1!=n.data("signIn")&&void e({},{type:"GET",url:"api/sign_in"}).then(function(e){e&&0==e.status&&(n.html("已签到"),n.data("signIn",!0),$('[data-name="credit"]',a).html(e.data.credit))}))});var i=new n;i.getUserInfo(),i.getCreditRule()})}});