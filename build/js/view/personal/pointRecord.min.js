!define(["conf","api","fun"],function(t,n,e){"use strict";return document.title="积分记录",function(t){$(function(){var i=function(){var i=$("#app"),a=$("#pointRecord",t),o=$("#loadMore",t),l=o.outerHeight(!0),r=this;this.bizCont={page:1},this.canLoadPage=!0,this.fetchData=function(){r.canLoadPage=!1,n(r.bizCont,{type:"GET",url:"api/user_credit_log"}).then(function(t){if(t&&0==t.status){var n=t.data;if(n.length>0){r.canLoadPage=!0,r.bizCont.page+=1;var l=r.renderList(n);a.append(l),l=null,e.isShowLoading(i,o)}else r.canLoadPage=!1,o.show(),1===r.bizCont.page?o.html("您暂时没有积分记录。"):o.html("没有更多数据")}else r.canLoadPage=!0,o.show(),o.html("没有更多数据")},function(){r.canLoadPage=!0,o.show(),o.html("请求数据失败")})},this.renderList=function(t){var n="";for(var e in t){var i=t[e],a=i.value.indexOf("-")>-1?"r-colorBlue":"r-colorRed",o='<div class="record__point '+a+'">'+i.value+"</div>";n+='<li><p class="record__tit">'+i.credit_type+'</p><p class="record__time">'+i.time+"</p>"+o+"</li>",i=null,a=null,o=null}return n},this.init=function(){i.on("scroll",function(){if(r.canLoadPage===!1)return!1;var t=i.get(0),n=t.scrollHeight,e=t.clientHeight,a=t.scrollTop;n-=l,a+e>=n&&r.fetchData(),t=null,n=null,e=null,a=null}),r.fetchData()}},a=new i;a.init()})}});