!define(["conf","api","fun"],function(n,t,a){"use strict";return document.title="积分记录",function(n){$(function(){var e=function(){var e=$("#app"),i=$("#pointRecord",n),o=$("#loadMore",n),l=o.outerHeight(!0),r=this;this.bizCont={page:1},this.canLoadPage=!0,this.fetchData=function(){r.canLoadPage=!1,t(r.bizCont,{type:"GET",url:"api/bill"}).then(function(n){if(n&&0==n.status){var t=n.data;if(t.length>0){r.canLoadPage=!0,r.bizCont.page+=1;var l=r.renderList(t);i.append(l),l=null,a.isShowLoading(e,o)}else r.canLoadPage=!1,o.show(),1===r.bizCont.page?o.html("您暂时没有积分记录。"):o.html("没有更多数据")}else r.canLoadPage=!0,o.show(),o.html("没有更多数据")},function(){r.canLoadPage=!0})},this.renderList=function(n){var t="";for(var a in n){var e=n[a],i='<div class="record__point r-colorBlue">-100</div>';t+='<li><p class="record__tit">'+e.phone_number+'</p><p class="record__time">'+e.created_at+"</p>"+i+"</li>",e=null,i=null}return t},this.init=function(){e.on("scroll",function(){if(r.canLoadPage===!1)return!1;var n=e.get(0),t=n.scrollHeight,a=n.clientHeight,i=n.scrollTop;t-=l,i+a>=t&&r.fetchData(),n=null,t=null,a=null,i=null}),r.fetchData()}},i=new e;i.init()})}});