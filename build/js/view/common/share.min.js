!define(["api","fun","conf","qrcode"],function(e,t,n,i){return document.title="SG易乐充",function(i){"use strict";$(function(){function a(e){var t=new Image;return t.src=e.toDataURL("image/png"),t}var o=n.dev?"/test":"",r="",s="正在获取积分规则，请稍后！",c=function(){this.testQRCode=function(e){var t=$("#shareQRCodes",i);if(e)$("#qrcodeImg",t).append('<img class="qrCodeImg" id="QRCode" src="'+o+'/build/img/QRCode.jpg" />');else{$("#qrDiv",t).qrcode({render:"canvas",width:t.height(),height:t.height(),text:"https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket="});var n=document.getElementsByTagName("canvas")[0],r=a(n);$("#qrcodeImg",t).append(r)}},this.getQRCode=function(){var t=$("#shareQRCodes",i);e({},{type:"GET",url:"api/qrcode"}).then(function(e){if(e&&0==e.status){$("#qrDiv",t).qrcode({render:"canvas",width:t.height(),height:t.height(),text:"https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket="+e.data.ticket});var n=document.getElementsByTagName("canvas")[0],i=a(n);$("#qrcodeImg",t).append(i)}else $("#qrcodeImg",t).append('<img class="qrCodeImg" id="QRCode" src="'+o+'/build/img/QRCode.jpg" />')})},this.getCredit=function(){e({},{type:"GET",url:"api/text?text_name=credit_rule"}).then(function(e){e&&0==e.status?r=t.formTips(e.data):s="暂无积分规则"})},this.weChatShare=function(){e({},{type:"GET",url:"api/user_info"}).then(function(e){if(e&&0==e.status){var t=e.data;wx.config({debug:!1,appId:t.app_id||"",timestamp:t.timestamp,nonceStr:t.nonceStr,signature:t.sign,jsApiList:["onMenuShareAppMessage","onMenuShareTimeline","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone","hideMenuItems"]}),wx.ready(function(){var e={title:"SG易乐充",desc:"SG易乐充,您的充值管家!",imgUrl:o+"/build/img/card.jpg",type:"link"};wx.onMenuShareAppMessage(e),wx.onMenuShareTimeline(e),wx.onMenuShareQQ(e),wx.onMenuShareWeibo(e),wx.onMenuShareQZone(e),wx.hideMenuItems({menuList:["menuItem:openWithQQBrowser","menuItem:openWithSafari","menuItem:copyUrl"]})})}})},this.init=function(){this.getQRCode(),this.getCredit(),this.weChatShare()}},d=new c;d.init(),$("#showDetail",i).on("click",function(e){return r?void layer.open({title:!1,btn:!1,area:["88%","88%"],anim:4,scrollbar:!1,content:r}):(t.swal(s,"info"),!1)})})}});